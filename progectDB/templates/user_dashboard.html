<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Utente</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Navbar -->
    {% include 'navbar.html' %}
    <div class="container mt-5">
      <h1 class="mb-4">I tuoi ordini</h1>

      {% if ordini %} {% for ordine in ordini %}
      <div class="card mb-4">
        <!-- Dati ordine -->
        <div class="card-header">
          <h4>Ordine #{{ ordine.id }}</h4>
          <p>
            <strong>Data Acquisto:</strong> {{ ordine.dataacquisto }}<br />
            <strong>Stato:</strong> {{ ordine.stato }}<br />
            <strong>Data Prevista:</strong> {{ ordine.dataprevista or 'Non
            disponibile' }}<br />
            <strong>Prezzo Totale:</strong> {{ ordine.prezzotot }} €
          </p>
        </div>

        <!-- Prodotti dell'ordine -->
        <div class="card-body">
          <h5>Prodotti nell'ordine:</h5>
          {% if ordini_prodotti[ordine.id] %}
          <ul class="list-group">
            {% for prodotto_id, prodotto in ordini_prodotti[ordine.id].items()
            %}
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <strong>{{ prodotto.nome }}</strong><br />
                <small>{{ prodotto.descrizione or '' }}</small>
                <br />
                <small
                  ><strong>Taglie:</strong> {{ prodotto.taglie | join(', ')
                  }}</small
                >
                <br />
                <strong>Quantità totale:</strong> {{ prodotto.quantita }}
              </div>
              {% if prodotto_id not in prodotti_recensiti %}
              <a
                href="{{ url_for('recensioni', ordine_id=ordine.id, prodotto_id=prodotto_id) }}"
                class="btn btn-primary"
              >
                Scrivi Recensione
              </a>
              {% else %}
              <p class="text-success">
                Recensione già inviata per questo prodotto
              </p>
              {% endif %}
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <p class="text-muted">Nessun prodotto trovato per questo ordine.</p>
          {% endif %}
        </div>
      </div>
      {% endfor %} {% else %}
      <div class="alert alert-info" role="alert">Non hai ordini recenti.</div>
      {% endif %}
    </div>


    <!-- Footer sempre in fondo -->
  <footer class="bg-dark text-white py-4 mt-auto">
    <div class="container text-center">
        <p>&copy; 2024 Shoe Store. Tutti i diritti riservati.</p>
        <ul class="list-inline">
            <li class="list-inline-item"><a href="#" class="text-white">Privacy Policy</a></li>
            <li class="list-inline-item"><a href="#" class="text-white">Termini di Servizio</a></li>
            <li class="list-inline-item"><a href="#" class="text-white">Supporto</a></li>
        </ul>
    </div>
</footer>

    
    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>

  </body>
</html>
